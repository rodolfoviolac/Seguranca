# INF01045 - Segurança Em Sistemas De Computação

## Samuel Rudnicki

## Criptografia Exercício 4

### Exercício 1

#### Texto Plano

>Gandalf tricks Bilbo Baggins into hosting a party for Thorin Oakenshield and his band of twelve dwarves, (Dwalin, Balin, Kili, Fili, Dori, Nori, Ori, Oin, Gloin, Bifur, Bofur, and Bombur) who sing of reclaiming the Lonely Mountain and its vast treasure from the dragon Smaug. When the music ends, Gandalf unveils Thrór's map showing a secret door into the Mountain and proposes that the dumbfounded Bilbo serve as the expedition's "burglar". The dwarves ridicule the idea, but Bilbo, indignant, joins despite himself.
The group travels into the wild, where Gandalf saves the company from trolls and leads them to Rivendell, where Elrond reveals more secrets from the map. When they attempt to cross the Misty Mountains they are caught by goblins and driven deep underground. Although Gandalf rescues them, Bilbo gets separated from the others as they flee the goblins. Lost in the goblin tunnels, he stumbles across a mysterious ring and then encounters Gollum, who engages him in a game of riddles. As a reward for solving all riddles Gollum will show him the path out of the tunnels, but if Bilbo fails, his life will be forfeit. With the help of the ring, which confers invisibility, Bilbo escapes and rejoins the dwarves, improving his reputation with them. The goblins and Wargs give chase, but the company are saved by eagles before resting in the house of Beorn.
The company enters the black forest of Mirkwood without Gandalf. In Mirkwood, Bilbo first saves the dwarves from giant spiders and then from the dungeons of the Wood-elves. Nearing the Lonely Mountain, the travellers are welcomed by the human inhabitants of Lake-town, who hope the dwarves will fulfil prophecies of Smaug's demise. The expedition travels to the Lonely Mountain and finds the secret door; Bilbo scouts the dragon's lair, stealing a great cup and espying a gap in Smaug's armour. The enraged dragon, deducing that Lake-town has aided the intruder, sets out to destroy the town. A thrush had overheard Bilbo's report of Smaug's vulnerability and reports it to Lake-town defender Bard. Bard's arrow finds the hollow spot and kills the dragon.
When the dwarves take possession of the mountain, Bilbo finds the Arkenstone, an heirloom of Thorin's family, and hides it away. The Wood-elves and Lake-men besiege the mountain and request compensation for their aid, reparations for Lake-town's destruction, and settlement of old claims on the treasure. Thorin refuses and, having summoned his kin from the Iron Hills, reinforces his position. Bilbo tries to ransom the Arkenstone to head off a war, but Thorin is only enraged at the betrayal. He banishes Bilbo, and battle seems inevitable.
Gandalf reappears to warn all of an approaching army of goblins and Wargs. The dwarves, men and elves band together, but only with the timely arrival of the eagles and Beorn do they win the climactic Battle of Five Armies. Thorin is fatally wounded and reconciles with Bilbo before he dies.
Bilbo accepts only a small portion of his share of the treasure, having no want or need for more, but still returns home a very wealthy hobbit roughly a year and a month after he first left.

#### 1. Obtenha o histograma do texto plano indicado

|Caractere|Quantidade|Proporção|
|-|-|-|
A|198|0.0782299486369024
B|72|0.0284472540497827
C|37|0.0146187277755828
D|110|0.0434610825760569
E|287|0.113393915448439
F|70|0.0276570525483998
G|64|0.0252864480442513
H|139|0.0549190043461083
I|180|0.0711181351244567
J|2|0.000790201501382853
K|16|0.00632161201106282
L|131|0.0517581983405768
M|67|0.0264717502963256
N|187|0.0738838403792967
O|200|0.0790201501382853
P|40|0.0158040300276571
Q|1|0.000395100750691426
R|165|0.0651916238640853
S|171|0.0675622283682339
T|209|0.0825760568945081
U|64|0.0252864480442513
V|35|0.0138285262741999
W|51|0.0201501382852627
X|2|0.000790201501382853
Y|33|0.0130383247728171

#### 2. Criptografe o texto plano indicado usando Cifra de César

>JDQGDOI WULFNV ELOER EDJJLQV LQWR KRVWLQJ D SDUWB IRU WKRULQ RDNHQVKLHOG DQG KLV EDQG RI WZHOYH GZDUYHV, (GZDOLQ, EDOLQ, NLOL, ILOL, GRUL, QRUL, RUL, RLQ, JORLQ, ELIXU, ERIXU, DQG ERPEXU) ZKR VLQJ RI UHFODLPLQJ WKH ORQHOB PRXQWDLQ DQG LWV YDVW WUHDVXUH IURP WKH GUDJRQ VPDXJ. ZKHQ WKH PXVLF HQGV, JDQGDOI XQYHLOV WKUóU'V PDS VKRZLQJ D VHFUHW GRRU LQWR WKH PRXQWDLQ DQG SURSRVHV WKDW WKH GXPEIRXQGHG ELOER VHUYH DV WKH HASHGLWLRQ'V "EXUJODU". WKH GZDUYHV ULGLFXOH WKH LGHD, EXW ELOER, LQGLJQDQW, MRLQV GHVSLWH KLPVHOI.
WKH JURXS WUDYHOV LQWR WKH ZLOG, ZKHUH JDQGDOI VDYHV WKH FRPSDQB IURP WUROOV DQG OHDGV WKHP WR ULYHQGHOO, ZKHUH HOURQG UHYHDOV PRUH VHFUHWV IURP WKH PDS. ZKHQ WKHB DWWHPSW WR FURVV WKH PLVWB PRXQWDLQV WKHB DUH FDXJKW EB JREOLQV DQG GULYHQ GHHS XQGHUJURXQG. DOWKRXJK JDQGDOI UHVFXHV WKHP, ELOER JHWV VHSDUDWHG IURP WKH RWKHUV DV WKHB IOHH WKH JREOLQV. ORVW LQ WKH JREOLQ WXQQHOV, KH VWXPEOHV DFURVV D PBVWHULRXV ULQJ DQG WKHQ HQFRXQWHUV JROOXP, ZKR HQJDJHV KLP LQ D JDPH RI ULGGOHV. DV D UHZDUG IRU VROYLQJ DOO ULGGOHV JROOXP ZLOO VKRZ KLP WKH SDWK RXW RI WKH WXQQHOV, EXW LI ELOER IDLOV, KLV OLIH ZLOO EH IRUIHLW. ZLWK WKH KHOS RI WKH ULQJ, ZKLFK FRQIHUV LQYLVLELOLWB, ELOER HVFDSHV DQG UHMRLQV WKH GZDUYHV, LPSURYLQJ KLV UHSXWDWLRQ ZLWK WKHP. WKH JREOLQV DQG ZDUJV JLYH FKDVH, EXW WKH FRPSDQB DUH VDYHG EB HDJOHV EHIRUH UHVWLQJ LQ WKH KRXVH RI EHRUQ.
WKH FRPSDQB HQWHUV WKH EODFN IRUHVW RI PLUNZRRG ZLWKRXW JDQGDOI. LQ PLUNZRRG, ELOER ILUVW VDYHV WKH GZDUYHV IURP JLDQW VSLGHUV DQG WKHQ IURP WKH GXQJHRQV RI WKH ZRRG-HOYHV. QHDULQJ WKH ORQHOB PRXQWDLQ, WKH WUDYHOOHUV DUH ZHOFRPHG EB WKH KXPDQ LQKDELWDQWV RI ODNH-WRZQ, ZKR KRSH WKH GZDUYHV ZLOO IXOILO SURSKHFLHV RI VPDXJ'V GHPLVH. WKH HASHGLWLRQ WUDYHOV WR WKH ORQHOB PRXQWDLQ DQG ILQGV WKH VHFUHW GRRU; ELOER VFRXWV WKH GUDJRQ'V ODLU, VWHDOLQJ D JUHDW FXS DQG HVSBLQJ D JDS LQ VPDXJ'V DUPRXU. WKH HQUDJHG GUDJRQ, GHGXFLQJ WKDW ODNH-WRZQ KDV DLGHG WKH LQWUXGHU, VHWV RXW WR GHVWURB WKH WRZQ. D WKUXVK KDG RYHUKHDUG ELOER'V UHSRUW RI VPDXJ'V YXOQHUDELOLWB DQG UHSRUWV LW WR ODNH-WRZQ GHIHQGHU EDUG. EDUG'V DUURZ ILQGV WKH KROORZ VSRW DQG NLOOV WKH GUDJRQ.
ZKHQ WKH GZDUYHV WDNH SRVVHVVLRQ RI WKH PRXQWDLQ, ELOER ILQGV WKH DUNHQVWRQH, DQ KHLUORRP RI WKRULQ'V IDPLOB, DQG KLGHV LW DZDB. WKH ZRRG-HOYHV DQG ODNH-PHQ EHVLHJH WKH PRXQWDLQ DQG UHTXHVW FRPSHQVDWLRQ IRU WKHLU DLG, UHSDUDWLRQV IRU ODNH-WRZQ'V GHVWUXFWLRQ, DQG VHWWOHPHQW RI ROG FODLPV RQ WKH WUHDVXUH. WKRULQ UHIXVHV DQG, KDYLQJ VXPPRQHG KLV NLQ IURP WKH LURQ KLOOV, UHLQIRUFHV KLV SRVLWLRQ. ELOER WULHV WR UDQVRP WKH DUNHQVWRQH WR KHDG RII D ZDU, EXW WKRULQ LV RQOB HQUDJHG DW WKH EHWUDBDO. KH EDQLVKHV ELOER, DQG EDWWOH VHHPV LQHYLWDEOH.
JDQGDOI UHDSSHDUV WR ZDUQ DOO RI DQ DSSURDFKLQJ DUPB RI JREOLQV DQG ZDUJV. WKH GZDUYHV, PHQ DQG HOYHV EDQG WRJHWKHU, EXW RQOB ZLWK WKH WLPHOB DUULYDO RI WKH HDJOHV DQG EHRUQ GR WKHB ZLQ WKH FOLPDFWLF EDWWOH RI ILYH DUPLHV. WKRULQ LV IDWDOOB ZRXQGHG DQG UHFRQFLOHV ZLWK ELOER EHIRUH KH GLHV.
ELOER DFFHSWV RQOB D VPDOO SRUWLRQ RI KLV VKDUH RI WKH WUHDVXUH, KDYLQJ QR ZDQW RU QHHG IRU PRUH, EXW VWLOO UHWXUQV KRPH D YHUB ZHDOWKB KREELW URXJKOB D BHDU DQG D PRQWK DIWHU KH ILUVW OHIW.

#### 3. Criptografe o texto plano indicado usando DES (CBC) com a chave indicada.

**Chave: 11 22 33 44 55 66 77 88**

>2E 02 0A DE C1 91 7C 47 94 AE 2B 4C 21 94 CA 57 2D F8 6E B5 97 31 3D B2 28 59 96 F1 61 50 CF 23 08 E0 83 55 99 67 9A AF 56 A3 4B 01 40 3D 28 E2 E7 4D 27 25 F3 38 8C 88 71 05 F8 B3 BF 82 EB 53 EE 77 E0 DD 38 18 07 84 C3 30 EE 7C F6 D8 41 A9 16 57 9F 73 B3 52 5F 60 46 0D 32 F0 BA 27 F5 C8 3C 0A A6 CC 5F 5B 96 0C FF 8D 96 64 60 77 71 5D 7B 7E 50 EF F2 38 88 1B 16 9C 5A 59 47 23 BB A3 49 A2 2C F2 AC 6F 61 0A 6E 90 38 26 9A E7 B9 03 C4 A7 97 2F BA 90 42 14 8F E0 EF 1F 29 AD 19 BA 2C D4 74 C5 24 4F 67 EA F0 9E 55 4A F0 D2 FD D4 04 DC 51 9F 60 44 F9 61 2D FC DF 1E 2C 85 7C A7 F6 83 B3 35 B0 AB B5 BF BB 2C 70 A0 B4 F8 8B DD EA 22 8E DC 50 B9 2B 26 4C C4 66 0B 1C 05 B1 C4 2E D9 AC 9F 2B 33 F1 C5 D2 20 0C D4 FC 81 26 C6 97 6D 83 CD 9B DA 05 0D CA B0 84 7E EE B0 5C CD 06 BD 66 4A BF 9C 58 EB 1F EE FB 1C 7A F1 93 D8 2C B4 88 82 2E 9D BC 3F 92 36 44 5D 28 17 5D FF 68 1D 5E 35 48 85 38 2A 98 D4 66 78 18 2A 78 9C 35 8D CD A7 A6 1A D3 85 F4 1D 3E 78 88 00 89 75 4A DB 61 A2 A4 BF F2 F3 D4 2E CC 4E 64 45 4D 69 52 AA 3A 0A 71 92 BD 05 A0 A1 6E 84 52 26 89 25 1A D4 9B CC 39 A3 5A CC 5A 7F B0 F8 E3 F5 FD 4E E1 19 A6 D0 A2 AE A8 FC 28 6B 52 9D C2 DE C4 42 2D 18 FD 6E D7 CB 46 DD 82 58 53 4A 22 B8 53 EC 59 B2 3D A2 D0 8D 9D 2B 8E 55 BB F6 35 E5 6C C5 E2 C2 E0 2C 28 FC 01 AF 88 74 CB B3 9D 46 3A A4 70 CA 86 47 4F DB 29 34 5C 62 EF 47 C5 09 96 DE 82 5D 1E A8 7C 75 63 73 B0 15 E8 63 CA 70 91 34 15 41 CC 25 37 02 AE D1 EF 3B 7E 9A 20 1F 61 E9 38 B5 4E 44 E2 7E CA 68 91 5A A9 7D BC 0F 04 DD 36 AA 18 D7 28 90 A4 1D 84 02 DB 82 D8 C4 7C 33 A3 EC 1E 84 48 4C 68 D4 F2 E2 E2 36 1A 0F 10 F0 8B A6 05 87 16 58 EB 95 D7 91 64 95 64 24 F7 B5 3A 9A 98 28 A6 5C C5 2D 2B 01 95 0F B6 72 4D D9 F5 46 79 1E 8E D0 9D 14 00 A9 33 BF 4A 60 3D C0 D9 7C 20 78 03 65 1D 37 89 4B EE 9C C4 CB 43 BC A8 C9 34 70 72 AF 59 0D B8 17 E4 3A 4A DE 3C 7A 13 24 63 55 B6 AD DC FE 51 0C C7 3F 6D 35 FA 2F B8 85 0E 0B 80 45 62 5D E9 8A 62 2A 71 DF C4 2B 86 13 AB 49 15 D3 AA 41 B3 B8 0F E5 FB 85 56 C5 4B 50 2F 8C 3C EC 3A 15 2B 8E D9 CF 61 29 8B 08 93 E9 FE 7C 93 9A 25 1B 86 A1 A9 7D 94 E3 2A DB DE 80 EF 3E 15 63 3E EF A7 9C 0D B4 40 9C 31 67 90 2C 57 58 41 8C B8 F2 59 5C 58 CE 32 51 FF 5D 24 8B EB 61 A4 11 76 78 F9 7E 59 E0 B4 A1 72 7D A4 9E F7 96 4E 5E 38 32 EA 3E 9E 39 76 73 ED 73 48 AA E9 CE 7F 48 D5 F1 8A 3D 60 50 F8 1E 3A 2A 24 42 EA 81 A7 D0 83 16 16 E0 23 4A 55 E3 A2 82 CE CC 94 21 1D 1F 27 86 26 2A D7 F6 32 C1 D0 A8 9A F2 2F 0B 06 99 EF 73 EC 5C C4 AF A6 B9 F9 0B C5 E7 E0 95 41 FB 5B 71 4D E1 04 37 D2 3E 79 35 79 E0 8A 01 83 3A 85 FC A3 94 66 27 C6 25 03 C1 AC 71 9A 62 52 65 CC E3 46 F7 45 0B BD 0E AC 6A FC B7 63 32 B3 17 C8 4B 07 79 D7 65 20 B9 EC 43 C7 0D 93 20 82 02 DF 6B F3 EE 1C 4F 36 79 6A 11 E8 08 0F 6E A5 8B 59 84 57 48 6C E4 7B BE 6A B8 E8 6D 70 00 60 3C FD 69 A4 13 A3 7A A1 D0 84 46 4B 55 28 B9 7E C0 BF 5F 5D D8 5A 26 52 B9 9B C4 A2 69 4C E9 93 56 0E 05 A5 A4 58 D0 0F 0C 45 40 58 67 70 6B A8 64 FC D6 D9 99 0A BA 4F C7 E4 20 E9 7F 7C 87 99 A7 B5 23 35 26 6A 1B F6 02 71 BD B9 23 43 55 B2 A6 7E 61 B6 22 D4 41 49 FA 6B 1C 4F 4D 4A 94 3C F0 BC 3B 22 96 A7 AA 40 EC 14 84 9A 7C CC 0F 41 63 DC D4 FF 52 DC 23 F1 07 ED 25 92 7E 40 3C 55 AF 32 26 62 32 69 6C 5F 38 5A 0D 18 2C DC 2D 18 5E 3E 3F 14 F5 76 19 52 82 CD 5C A9 60 64 6D 8C 38 F4 08 8D 73 64 5F 42 2F F4 69 8F 1C EA 15 74 B2 74 37 D1 21 BF B1 87 E4 EB D7 FF B7 73 63 0B A9 2D 4E C6 1F 25 26 73 6B 4C 14 99 C3 75 77 D0 DD 94 22 89 FE 96 5B F5 F3 84 69 4C 99 62 87 E1 81 6C 53 31 D6 1D 69 1C DC 2A 5E 50 3B 56 64 D6 F4 AA 52 31 D0 D0 61 20 F9 3D F3 BA AD FE 0D B2 76 EF F3 6C 5B D3 DC F6 42 28 16 DB 06 DA 4E 56 F2 0F 4F CA 98 E4 74 5C F8 D3 EA 0F 25 6C 7B 13 B4 5F 17 EA 2F 1D BC 57 C3 84 3A 96 52 A2 02 FD 73 33 8B 5F 14 73 86 7C FC 55 46 7B 1B 31 D5 0F FF 24 CA F0 38 FE BF 2B A9 4B FD F8 9A 89 35 C9 E8 0C 28 AD E3 B5 BC 06 F4 A7 96 A0 ED 8F 67 75 A4 2F 7F AA 15 E4 1C 9E B7 4F 7D 79 DE B8 84 E9 81 21 CC 25 84 38 B1 7D CC 72 37 23 44 60 41 F6 CB 97 33 09 53 F7 33 6B 7E 4B E0 32 6B B3 3A C3 B3 75 79 4D 76 7F 05 63 F6 3D 6B EE 8B E2 FC 7B 01 EA 34 C6 8B 42 55 03 E7 03 CF EB 83 25 9C 20 BA 1B DB 6C F3 76 F7 EC A7 0C 61 5E 7A A2 AF F7 9E 68 F3 89 18 5C 6C F8 3E 31 F4 66 DD 86 AC 37 1B 97 46 9F 0E B6 52 E3 ED 77 D7 09 52 41 3A 72 5B D3 5B 75 B0 A4 06 B8 98 9E 7F 64 40 5F B6 3E 24 87 7C 1C FB C5 ED 3E 95 79 A8 42 C7 25 60 20 3D 47 AB E3 8B 44 EE BC 0F 4D 40 AF 85 AC 53 8A CC 01 39 EE CA 4B CE 0C FB 2B 8E 81 B0 3A 9E 1A 8D 58 AF C7 0F 7F 02 50 11 36 A2 7E 56 60 A8 41 43 4D 2B CD 66 10 AF 90 7E D1 FE D8 79 CD E2 D0 E2 4B 4F 60 97 D6 DA 82 7B 72 0D CC 32 1C 8D 3D 5B C6 C5 5E B6 6C 2C 6B A2 30 2C 72 E6 8C EE 8C 8B A7 CB 6B 76 EE 66 99 B4 92 CF 4B 96 4E 84 2A A0 BC 7C 6D 6C 67 FB 3A 0C 7F F6 BA A0 6E 5E 2A BF 85 BA DE 42 DF 77 51 C6 23 DD F6 6F 71 85 DC 2B B4 4C 11 45 F3 C1 D7 03 8C 6F 22 2C B6 87 63 4F 26 5B EE B4 96 E7 DD 85 31 47 9F 14 B6 61 D6 8B 77 D7 D7 34 62 DA 39 29 21 C3 BF FD 9A F8 32 71 C1 23 3E D5 F5 2F 20 6C 85 D2 69 B3 C3 5B 16 B1 23 FB B7 29 01 DC E4 EA 20 06 13 4B AD 12 7B C4 D4 33 C8 09 61 CD C9 74 90 55 DE 8B E8 B7 5E 6B D4 B8 5B F3 9B 3A 98 9D 3D 67 24 BE A4 F3 FF 97 11 00 E8 8A AD 2A 5A F3 A5 64 FB C6 BD B1 93 C5 0C 02 BF E7 9C 8B 76 84 24 5B 91 30 3E 73 95 E7 05 EB 21 02 05 99 E3 32 55 D7 6A 14 DE 06 CD 3A 7A 1A 50 FA E3 85 82 59 36 98 0E 86 EC BD 0B 5B 1A 0F 77 B8 A5 72 AD 2F 61 49 36 DC 99 80 44 EB 27 2F 96 DC 85 FB 5B 80 62 F3 36 E9 80 C4 9C D5 37 DB C5 FA 3C 9B 6D 3A B2 C3 80 34 6A 39 C5 17 D1 6C A5 07 76 FC 2E 90 1C 75 AF 48 1E 43 3B 43 87 AD 4E CB 31 A4 5B A9 5A 71 ED F1 E3 AF 9F 6C 01 50 68 23 D1 BB 9B 28 7E E4 D2 6F EC 18 BC 79 47 57 99 10 C9 AB 7D B5 41 04 CE FF F9 AD 6B 79 C1 16 A2 65 58 7B D0 56 0F 67 6F 44 82 8C 4B 5E 13 C6 46 62 E8 A8 C5 68 30 4F E8 17 26 DD A0 3C 33 D8 C8 4C B8 49 EC 66 EF CE 80 00 88 E6 34 BC B5 8E 15 28 2A AC A6 AC B4 72 49 DA 3A 62 93 A5 EA 22 3D 56 2F 3F 69 F1 F8 9C B1 FD 45 E4 52 E3 F1 54 F8 56 FB F4 F7 E4 AB 4C 59 93 F1 02 81 F8 78 E3 66 62 E0 07 F1 68 5D 82 7F F7 F6 AA 81 97 49 7D C1 D4 B2 DA C3 19 7F 94 7A 96 DF BB 27 ED 54 89 37 ED D0 F3 97 EE DE 0E CE 79 CB 08 3D 0F 2B 95 05 F5 AE 7A C0 14 DB F8 CA 11 BE 96 99 F3 D3 3A 61 8C 27 39 56 EA 2E 5E 1E 39 50 39 05 CC FE B0 DC 6D FA 9E 4C 08 DF 84 63 EF B7 FE D7 9C FB 8B D5 80 E8 6A E7 A3 36 E4 F5 4C 67 DB 82 13 BC 5F B7 23 54 04 95 14 79 0C 46 1A 88 2E 05 0D CE 03 2A 13 A1 E5 F7 AF 83 E4 25 30 7C 7A E3 53 53 5C 13 5B 11 C7 A7 88 99 C3 62 4C 7C 00 5D 8F 14 D9 90 A1 82 EB 11 BE 15 31 35 31 B8 33 AA 65 A0 48 87 38 FC 3F 04 75 40 C6 8F 95 97 81 E8 6B 4C F5 74 11 D1 AD 4E DF 5A 0F E0 97 5A C4 96 34 54 F5 23 E5 E7 37 23 CF C8 6D E9 27 64 98 01 40 40 85 3F D5 41 BC 7F BC 86 31 8E 88 EE 81 C2 44 62 96 B3 A8 9C 3A 56 06 66 A8 60 5D 9E 1C 5D 9C 98 38 6C 3F 22 09 93 54 FE A7 30 EE 36 C7 8A 79 CD A1 2C 29 5B FB A7 FD BE C4 CA 45 C2 C8 8C F8 BC 8C E1 92 78 F9 44 ED A7 80 7B F8 D8 9D B3 05 CC 5B A7 19 53 15 09 A5 99 34 00 CA 9A 9F 55 AB 22 1D 4F 86 D2 82 EB 50 CA 4F 97 1F B0 E6 61 26 B5 0C E3 93 72 1E 48 BF 1F 45 7F 7B 32 2D 25 D8 1C DD 3C 33 88 CC 66 99 EA 89 E6 60 1C 17 6E 93 48 A1 83 31 D4 F0 13 B5 DE EA D2 8A A2 96 90 46 2E 4E 62 55 36 74 2A E0 8D 22 14 8F E8 FD 60 21 AD 5C 64 E0 08 AE AE C6 8B 79 61 CB 05 05 3B D0 7D CB 83 69 BD 4E 90 D4 EF AC 7D CA E9 48 95 58 C4 2B 02 5F 10 BB A5 58 77 F9 3D 78 F5 9F F0 3E 70 94 4E 8B 80 06 A1 83 33 24 04 9C 21 2D 8F 84 20 34 0A 6E A3 FA 9F 15 99 83 DC 1D 99 D2 08 54 B1 DF 35 C4 B7 F1 84 90 3C 71 98 50 C0 62 C7 80 4A C4 16 74 E2 EE 9E EB 7C 2E C2 49 F6 D5 F9 13 D0 D6 E1 1C E0 60 85 E9 52 98 3F 70 88 6A 72 D0 B9 EE 0D 92 57 1E 76 74 25 52 0C AD 09 9C 6A 26 74 E1 23 88 80 46 68 10 71 0D FE B6 6F 7A 37 56 EE B2 09 72 A4 86 2C A7 92 53 53 F9 12 AB D7 53 FD 0E F3 35 C6 F1 E0 72 92 71 B8 B3 6F B0 49 1C 90 FE F0 67 CD DC 5D 29 62 7D 6D D9 91 B6 A0 AE 00 C0 85 BD 40 0B 24 CC 97 A9 96 EA B2 D2 73 19 2E 2E 0C 6F 74 92 44 BC 2E E5 76 F1 E4 C5 C0 E6 2A B6 F2 F0 3F 75 BE B3 EF EB EE 9F 6B EC 96 EC A7 B0 7D 52 88 68 2E 37 04 BA CA 0D 8E DB 5D 77 8D 1D 18 E7 64 8B 30 EA DF D7 5E A3 2F 80 3A 6D 05 56 05 A0 0E D2 BC FB 3B 60 27 47 6A 22 2E 16 84 1F A8 14 94 F8 78 DF B7 8F 52 63 73 57 11 6B 28 A3 D2 D7 E9 4D 83 97 D2 7B 0C 6A D8 4E 5E AE 87 98 3D 67 E5 FD 78 59 F2 EB F5 35 F4 02 90 E3 33 67 DA F6 EA 46 99 9C CA 78 94 E9 67 0C 76 F9 56 BD C2 A2 5C DD 65 E9 DD 15 43 23 9C C7 75 CA AE AD A1 A7 AC 22 06 0C 78 89 DC B8 B9 C3 9C 84 CF 1F F6 32 39 84 45 AA F9 8B 78 85 97 BD D3 BC 8E D2 9A B3 6A 0D D4 B8 DB 8E 37 10 85 79 D1 0D 9C 85 43 DE 09 E4 70 E6 C8 A7 57 36 16 02 95 D5 DE 52 8C 38 A2 49 71 D3 F4 83 26 F4 43 7A 36 9D B0 3F D1 AA CA 71 C1 32 4E 68 76 B3 77 B1 9E 36 26 ED 94 B5 EE 3D 15 D2 3D 94 99 94 93 C2 43 EF 97 20 92 D3 E7 54 CA 52 10 0D E8 E0 F8 52 57 CB F6 CA 2E 5D BF 66 90 3D 4D 3A 1D 9E D1 FD FE 6A E0 98 D8 EB C9 D5 48 B8 74 12 9E 38 D7 B1 03 05 92 F8 10 E0 15 A8 FD 70 25 BC 38 4C 6E 9F 08 F5 43 C7 BC 37 07 7A 89 21 1F 3B 66 90 CA C5 2B 62 2D A8 5F 1E C5 05 B9 98 74 8D CE C5 C3 74 5C 81 88 3F 7E AE CE B4 5A E3 8C CC 49 DA EC 48 0A 7B 09 3E 4C 91 B8 DA 93 DA 8F 80 A3 2D 71 FD EE 2F 8E F4 64 D9 E5 CA AC 1E 75 77 AD 55 46 D1 E6 B2 EA 50 1A 6F 07 F0 7C 8E 17 BE 98 0F 09 E4 10 7D CF D8 4D D5 75 3F 6B 99 8B 7F 5B 61 6F 50 93 AB 57 0E 95 45 A9 F9 F4 54 58 E4 6E 2B 2D C4 FB B9 89 BE 49 73 3A B4 4F BF 34 61 B2 B5 C3 E2 72 36 17 9E F9 56 C9 8E 26 43 FB 49 AD F2 A2 C4 32 E4 8D 16 94 F3 6C 42 DC 0A AA EA E9 83 B6 BD 9E 23 C6 F3 DB F3 1F D9 7B 13 09 D8 77 DD D4 DA 7C 50 4B 09 2B CC 71 27 F3 79 97 A1 6F B8 B9 AF B4 84 95 DB 29 EA 60 6B 19 AA A6 CF D8 2B FE 00 13 06 2E 87 6B 1F 9E 39 72 00 FB D5 58 71 D0 50 51 F0 47 F8 8B DB 70 60 CB 46 40 0F

#### 4. Obtenha os histogramas dos textos criptografados

#### Histograma com cifragem de César

|Caractere|Quantidade|Proporção|
|-|-|-|
A|2|0.000790201501382853
B|33|0.0130383247728171
D|198|0.0782299486369024
E|72|0.0284472540497827
F|37|0.0146187277755828
G|110|0.0434610825760569
H|287|0.113393915448439
I|70|0.0276570525483998
J|64|0.0252864480442513
K|139|0.0549190043461083
L|180|0.0711181351244567
M|2|0.000790201501382853
N|16|0.00632161201106282
O|131|0.0517581983405768
P|67|0.0264717502963256
Q|187|0.0738838403792967
R|200|0.0790201501382853
S|40|0.0158040300276571
T|1|0.000395100750691426
U|165|0.0651916238640853
V|171|0.0675622283682339
W|209|0.0825760568945081
X|64|0.0252864480442513
Y|35|0.0138285262741999
Z|51|0.0201501382852627

#### Histograma com cifragem DES

|Caractere|Quantidade|Proporção|
|-|-|-|
A|30|0.0459418070444104
B|26|0.0398162327718224
C|23|0.0352220520673813
D|24|0.0367534456355283
E|16|0.0245022970903522
F|28|0.0428790199081164
G|22|0.0336906584992343
H|22|0.0336906584992343
I|23|0.0352220520673813
J|22|0.0336906584992343
K|31|0.0474732006125574
L|30|0.0459418070444104
M|21|0.0321592649310873
N|24|0.0367534456355283
O|24|0.0367534456355283
P|27|0.0413476263399694
Q|23|0.0352220520673813
R|35|0.0535987748851455
S|26|0.0398162327718224
T|23|0.0352220520673813
U|27|0.0413476263399694
V|28|0.0428790199081164
W|23|0.0352220520673813
X|26|0.0398162327718224
Y|27|0.0413476263399694
Z|22|0.0336906584992343

#### 5. Compare os histogramas. Como é possível explicar suas observações?

>O histograma do texto encriptado com a cifra de César apresenta a mesma frequência de caracteres do texto puro, apenas deslocada três posições para a direita, por se tratar de uma cifra de substituição.
Já no algoritmo da cifra DES, os bits são rearranjados, perdendo-se a utilidade de uma análise de frequencia.

### Exercício 2

#### 1. Criptografe o texto plano indicado (M=Bob's salary is $25000--Tom's salary is $15000) usando DES (ECB) com a chave indicada (K = 11 22 33 44 55 66 77 88).

>AE 46 F7 21 FE D4 E8 28 C3 45 4F 51 ED 2C ED CB FC EA 02 F1 22 C8 56 9F 31 9D 2E 19 D8 F9 82 42 C3 45 4F 51 ED 2C ED CB A8 1B 89 BB EF A6 E0 42

#### 2. Copie os blocos cifrados resultantes (C1, C2, ... Ck).

|Bloco|Conteúdo|
|-|-|
C1| AE 46 F7 21 FE D4 E8 28 
C2| C3 45 4F 51 ED 2C ED CB
C3| FC EA 02 F1 22 C8 56 9F 
C4| 31 9D 2E 19 D8 F9 82 42 
C5| C3 45 4F 51 ED 2C ED CB 
C6| A8 1B 89 BB EF A6 E0 42

#### 3. Troque os blocos resultantes C1 e C4 para obter uma sequência de blocos cifrados (C4, C2, C3, C1 ... Ck).

>31 9D 2E 19 D8 F9 82 42 C3 45 4F 51 ED 2C ED CB FC EA 02 F1 22 C8 56 9F AE 46 F7 21 FE D4 E8 28 C3 45 4F 51 ED 2C ED CB A8 1B 89 BB EF A6 E0 42

#### 4. Decriptografe o texto cifrado resultante. Qual a mensagem obtida? Explique.

#### Encriptação

>AE 46 F7 21 FE D4 E8 28 97 5F FB A8 24 07 9D A0 37 6A E0 93 89 D8 0D 4C 8C 99 36 C3 83 B8 81 A9 D4 70 C3 E2 D9 C4 66 C5 C9 AF 33 4A 5E 8D 48 44

#### Blocos

|Bloco|Conteúdo|
|-|-|
C1| AE 46 F7 21 FE D4 E8 28 
C2| 97 5F FB A8 24 07 9D A0 
C3| 37 6A E0 93 89 D8 0D 4C 
C4| 8C 99 36 C3 83 B8 81 A9 
C5| D4 70 C3 E2 D9 C4 66 C5 
C6| C9 AF 33 4A 5E 8D 48 44

#### Troca dos blocos C1 e C4

>8C 99 36 C3 83 B8 81 A9 97 5F FB A8 24 07 9D A0 37 6A E0 93 89 D8 0D 4C AE 46 F7 21 FE D4 E8 28 D4 70 C3 E2 D9 C4 66 C5 C9 AF 33 4A 5E 8D 48 44

#### Decriptação

>c~-N]$25000--u~-N]$15000

No CBC, os blocos de texto puro são encadeados com o uso de uma função XOR associada ao bloco cifrado anterior. Se os blocos criptografados forem movidos, perde-se esta sequencia e, consequentemente, a mensagem.

### Exercício 3
#### 1. Encripte o texto indicado (M=Bob's salary is $25000--Tom's salary is $15000) com DES(CBC). Escolha a chave.
**Chave: 1122334455667788**

>AE 46 F7 21 FE D4 E8 28 97 5F FB A8 24 07 9D A0 37 6A E0 93 89 D8 0D 4C 8C 99 36 C3 83 B8 81 A9 D4 70 C3 E2 D9 C4 66 C5 C9 AF 33 4A 5E 8D 48 44

#### 2. Considerando a sequência criptografada, modifique os blocos para causar a seguinte modificação na mensagem decriptografada: $15000 -> $.5000. Explique como isso foi realizado.

>Analizando a mensagem percebe-se que $15000 está no ultimo bloco. Então realiza-se um XOR da mensagem criptografada a ser inserida, $.5000, com o bloco anterior, C5; o bloco resultante da operação é posicionado em C6.

|Bloco|Conteúdo|
|-|-|
C1| AE 46 F7 21 FE D4 E8 28 
C2| 97 5F FB A8 24 07 9D A0 
C3| 37 6A E0 93 89 D8 0D 4C 
C4| 8C 99 36 C3 83 B8 81 A9 
C5| D4 70 C3 E2 D9 C4 66 C5 
C6| C9 AF 33 4A 5E 8D 48 44
C6 (novo)| 37 6A E0 93 89 D8 0D 4C 

#### Nova mensagem criptografada

>AE 46 F7 21 FE D4 E8 28 97 5F FB A8 24 07 9D A0 C9 AF 33 4A 5E 8D 48 44 8C 99 36 C3 83 B8 81 A9 D4 70 C3 E2 D9 C4 66 C5 37 6A E0 93 89 D8 0D 4C

#### 3. Todos os blocos criptografados são decriptados corretamente depois dessa modificação? Explique.

>Sim, pois o CBC realiza o encadeamento dos blocos de texto puro com os seus respectivos blocos anteriores criptografados. Assim, uma modificação no último bloco afeta apenas o mesmo.

#### 4. O modo de operação CBC assegura integridade? Explique considerando o exercício realizado.

>Não, pois o ultimo bloco da mensagem criptografada pode ser modificado sem que esta modificação seja aparente na decriptação.
